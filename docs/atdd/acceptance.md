# 受け入れ基準（Acceptance Criteria）

このドキュメントは、ポモドーロタイマーアプリケーションのユーザーストーリーと受け入れ基準を定義します。

## エピック: ポモドーロタイマーアプリケーション

時間管理と集中力向上のために、ポモドーロテクニックを実践できるWebアプリケーションを提供する。

---

## ユーザーストーリー 1: デフォルトポモドーロモード

**As a** ユーザー
**I want to** シンプルなポモドーロタイマーを使用する
**So that** 作業と休憩のサイクルを簡単に管理できる

### 受け入れ基準（Acceptance Criteria）

#### AC 1.1: 基本的なタイマー操作
- **Given** アプリが待機状態である
- **When** スタートボタンをクリックする
- **Then** 25分（デフォルト）のカウントダウンタイマーが開始される
- **And** タイマー表示が更新される（MM:SS形式）

#### AC 1.2: 作業完了時の通知
- **Given** 作業タイマーが実行中で残り時間が0秒になった
- **When** タイマーが完了する
- **Then** 5秒間ビープ音が鳴る
- **And** 自動リピートがオンの場合、5分の休憩タイマーが自動的に開始される

#### AC 1.3: タイマーの一時停止と再開
- **Given** タイマーが実行中である
- **When** 一時停止ボタンをクリックする
- **Then** タイマーが一時停止する
- **And** 再開ボタンをクリックすると、残り時間からタイマーが再開される

#### AC 1.4: タイマーの停止
- **Given** タイマーが実行中または一時停止中である
- **When** 停止ボタンをクリックする
- **Then** タイマーが停止し、待機状態に戻る

---

## ユーザーストーリー 2: 時間設定のカスタマイズ

**As a** ユーザー
**I want to** 作業時間と休憩時間をカスタマイズする
**So that** 自分のペースに合わせたポモドーロサイクルを実行できる

### 受け入れ基準（Acceptance Criteria）

#### AC 2.1: 作業時間の変更
- **Given** デフォルトモードの待機状態である
- **When** 設定パネルで作業時間の増減ボタン（+1分、+5分、+25分、-1分、-5分、-25分）をクリックする
- **Then** 作業時間が選択した分数だけ増減される
- **And** 作業時間は最小1分、最大60分の範囲内である

#### AC 2.2: 休憩時間の変更
- **Given** デフォルトモードの待機状態である
- **When** 設定パネルで休憩時間の増減ボタンをクリックする
- **Then** 休憩時間が選択した分数だけ増減される
- **And** 休憩時間は最小1分、最大15分の範囲内である

#### AC 2.3: 音量調整
- **Given** 設定パネルを開いている
- **When** 音量スライダーを動かす
- **Then** 音量が0〜100%の範囲で変更される
- **And** テストボタンをクリックすると、設定した音量で1秒間ビープ音が鳴る

#### AC 2.4: 設定のリセット
- **Given** 設定を変更した状態である
- **When** リセットボタンをクリックする
- **Then** 作業時間25分、休憩時間5分、音量50%、自動リピートオンのデフォルト値に戻る

---

## ユーザーストーリー 3: 自動リピート機能

**As a** ユーザー
**I want to** 作業と休憩のサイクルを自動的に繰り返す
**So that** 手動で毎回タイマーを開始する手間を省ける

### 受け入れ基準（Acceptance Criteria）

#### AC 3.1: 自動リピートの切り替え
- **Given** 設定パネルを開いている
- **When** 自動リピートのトグルスイッチをクリックする
- **Then** 自動リピート設定がオン/オフに切り替わる

#### AC 3.2: 作業完了後の自動遷移
- **Given** 自動リピートがオンで、作業タイマーが完了した
- **When** ビープ音が鳴り終わる（5秒経過）
- **Then** 休憩タイマー（設定値）が自動的に開始される

#### AC 3.3: 休憩完了後の自動遷移
- **Given** 自動リピートがオンで、休憩タイマーが完了した
- **When** ビープ音が鳴り終わる（5秒経過）
- **Then** デフォルトモードでは作業タイマー（設定値）が自動的に開始される

#### AC 3.4: 自動リピートオフ時の動作
- **Given** 自動リピートがオフで、タイマーが完了した
- **When** ビープ音が鳴り終わる（5秒経過）
- **Then** 待機状態に戻り、自動的には次のタイマーが開始されない

---

## ユーザーストーリー 4: 計画ポモドーロモード

**As a** ユーザー
**I want to** 時刻ベースでポモドーロを計画する
**So that** 一日のスケジュールに合わせてポモドーロを実行できる

### 受け入れ基準（Acceptance Criteria）

#### AC 4.1: ポモドーロの追加
- **Given** 計画モードの待機状態である
- **When** タスク名、開始時刻、作業終了時刻、休憩終了時刻を入力し、追加ボタンをクリックする
- **Then** 入力した情報でポモドーロが計画リストに追加される

#### AC 4.2: 時刻の個別指定
- **Given** 計画モードの待機状態である
- **When** 開始時刻（例：9:00）、作業終了時刻（例：9:25）、休憩終了時刻（例：9:30）を個別に入力する
- **Then** 指定した各時刻でポモドーロが追加される

#### AC 4.3: 時刻の自動入力（開始時刻）
- **Given** 計画モードの待機状態で追加フォームを開いている
- **When** 開始時刻（例：10:00）を入力する
- **Then** 設定されている作業時間（例：25分）と休憩時間（例：5分）から、作業終了時刻（10:25）と休憩終了時刻（10:30）が自動的に入力される
- **And** 自動入力された値は手動で変更可能

#### AC 4.4: 時刻の自動入力（作業終了時刻）
- **Given** 計画モードの待機状態で追加フォームを開いている
- **When** 作業終了時刻（例：11:00）を入力する
- **Then** 設定されている休憩時間（例：5分）から、休憩終了時刻（11:05）が自動的に入力される

#### AC 4.5: 連続したポモドーロの時刻設定
- **Given** 計画リストに既にポモドーロが1つ以上ある
- **When** 新しいポモドーロを追加する
- **Then** 前のポモドーロの休憩終了時刻が次のポモドーロの開始時刻のデフォルト値として自動設定される
- **And** 開始時刻は変更可能

#### AC 4.6: タスク名の編集
- **Given** 計画リストにポモドーロが表示されている
- **When** タスク名の入力欄をクリックして編集する
- **Then** タスク名が変更される

#### AC 4.7: ポモドーロの削除
- **Given** 計画リストにポモドーロが表示されている
- **When** 削除ボタンをクリックする
- **Then** 選択したポモドーロが計画リストから削除される

#### AC 4.8: 実行中の編集制限
- **Given** タイマーが実行中または一時停止中である
- **When** ポモドーロの追加・編集・削除ボタンをクリックしようとする
- **Then** 各ボタンが無効化されており、操作できない

---

## ユーザーストーリー 5: 計画モードのタイマー実行

**As a** ユーザー
**I want to** 計画したポモドーロを時刻通りに実行する
**So that** 正確なスケジュール管理ができる

### 受け入れ基準（Acceptance Criteria）

#### AC 5.1: 計画モードでのタイマー開始
- **Given** 計画リストにポモドーロが登録されている
- **When** スタートボタンをクリックする
- **Then** 最初のポモドーロの作業タイマーが開始される
- **And** 該当ポモドーロが青色でハイライト表示される

#### AC 5.2: 自動開始機能
- **Given** 計画モードの待機状態で、自動リピートがオンで、計画リストにポモドーロがあり、現在時刻が開始時刻以降である
- **When** 10秒間待機する（自動チェック間隔）
- **Then** 最初のポモドーロの作業タイマーが自動的に開始される

#### AC 5.3: 正確な時刻管理（作業時間）
- **Given** 計画モードで開始時刻9:05、作業終了時刻9:25のポモドーロが現在時刻9:05に開始された
- **When** タイマーが動作する
- **Then** 現在時刻と作業終了時刻の差分（20分）が計算される
- **And** タイマーは20分でカウントダウンし、9:25きっかりに作業が完了する

#### AC 5.4: 正確な時刻管理（休憩時間）
- **Given** 計画モードで作業終了時刻9:25、休憩終了時刻9:30のポモドーロの作業が完了した
- **When** 休憩タイマーが開始される
- **Then** 現在時刻と休憩終了時刻の差分（5分）が計算される
- **And** タイマーは5分でカウントダウンし、9:30きっかりに休憩が完了する

#### AC 5.5: 複数ポモドーロの自動進行
- **Given** 計画リストに複数のポモドーロがあり、最初のポモドーロの休憩時間が終了した
- **When** ビープ音が鳴り終わる（5秒経過）
- **Then** 自動リピートがオンの場合、次のポモドーロの作業タイマーが自動的に開始される

#### AC 5.6: 計画完了時の動作
- **Given** 計画リストの最後のポモドーロの休憩時間が終了した
- **When** ビープ音が鳴り終わる（5秒経過）
- **Then** 待機状態に戻り、自動的には次のタイマーが開始されない

---

## ユーザーストーリー 6: モード切替

**As a** ユーザー
**I want to** デフォルトモードと計画モードを切り替える
**So that** 状況に応じて最適なモードを使用できる

### 受け入れ基準（Acceptance Criteria）

#### AC 6.1: モードの切り替え
- **Given** 待機状態でモード切替ボタンが表示されている
- **When** デフォルトモード/計画モードの切替ボタンをクリックする
- **Then** 選択したモードの画面に切り替わる

#### AC 6.2: 実行中のモード切替制限
- **Given** タイマーが実行中または一時停止中である
- **When** モード切替ボタンをクリックしようとする
- **Then** モード切替ボタンが無効化されており、操作できない

#### AC 6.3: 計画モードの設定表示
- **Given** 計画モードの待機状態で設定パネルを開いている
- **When** 設定パネルを確認する
- **Then** 作業時間と休憩時間の設定項目が表示されず、音量と自動リピートの設定のみが表示される

---

## ユーザーストーリー 7: データの永続化

**As a** ユーザー
**I want to** 設定と計画を保存する
**So that** ブラウザを閉じても情報が失われない

### 受け入れ基準（Acceptance Criteria）

#### AC 7.1: 設定の永続化
- **Given** 設定を変更した
- **When** ブラウザを再読み込みする
- **Then** 変更した設定が保持されている

#### AC 7.2: 計画リストの永続化
- **Given** 計画モードでポモドーロを追加した
- **When** ブラウザを再読み込みする
- **Then** 追加した計画リストが保持されている

---

## ユーザーストーリー 8: 視認性の向上

**As a** ユーザー
**I want to** 見やすいUIで操作する
**So that** 快適にアプリを使用できる

### 受け入れ基準（Acceptance Criteria）

#### AC 8.1: 高コントラストの配色
- **Given** アプリを使用している
- **When** 画面を確認する
- **Then** テキストと背景の明度差が十分に確保されている
- **And** 入力フィールドは白い背景に濃い文字色（gray-900）を使用している

#### AC 8.2: 実行中の視覚的識別
- **Given** 計画モードでタイマーが実行中である
- **When** 画面を確認する
- **Then** 現在実行中のポモドーロが青色でハイライト表示される

---

## 技術的制約

### システム構成
- XState v5による状態管理
- localStorage によるデータ永続化
- Tailwind CSS v4 によるスタイリング
- Web Audio API による音声通知

### 制限事項
- ポモドーロの長さ: 最小1分、最大60分
- 休憩間隔: 最小1分、最大15分
- ポモドーロと休憩間隔の合計: 最小2分、最大120分
- デフォルトモードと計画モードは排他的（同時使用不可）

---

## テスト戦略

各ユーザーストーリーの受け入れ基準は、`scenario-test-case.tsv` に記載されたシナリオテストケースでカバーされています。

- **テストケース総数**: 37件
- **カバレッジ**: 全8ユーザーストーリーの全受け入れ基準をカバー
- **テスト形式**: Given/When/Then形式のBDD（振る舞い駆動開発）スタイル
